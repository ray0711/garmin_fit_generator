<div class="workout-container">
  <div cdkDropListGroup>
    <div class="list-header">
      <h2>Building Blocks</h2>
      <div
        cdkDropList
        [cdkDropListData]="buildingBlocks"
        cdkDropListSortingDisabled
        cdkDropListHasAnchor
        class="workout-list"
      >
          @for (block of buildingBlocks; track block.name) {
            <app-exercise [block]="block" class="block-box" (add)="addBlock($event)" />
          }
      </div>
      <mat-card appearance="outlined">
        <mat-card-header>
          <mat-card-title>Default Step Target</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <app-step-target [(workoutBlock)]="templateTarget" />
          <mat-card-actions>
            <button matFab extended (click)="applyDefaultTarget()">
              <mat-icon aria-hidden="true">app_registration</mat-icon>
              Apply to selected
            </button>
          </mat-card-actions>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="list-header">
      <h2>Workout</h2>
      <mat-tree
        [dataSource]="flatWorkoutOutput()"
        [trackBy]="treeTracker"
        [levelAccessor]="levelAccessor"
        class="workout-list"
        cdkDropList
        (cdkDropListDropped)="drop($event)"
        #workoutTree
      >
        <mat-tree-node *matTreeNodeDef="let node" class="block-box" cdkDropList cdkDrag>
          <app-control
            [block]="node.block"
            (blockChange)="updateBlockInWorkout($event)"
            (deleteMe)="deleteBlock(node)"
            [class]="levelStyle(node)"
          />
        </mat-tree-node>
      </mat-tree>
    </div>
  </div>
</div>

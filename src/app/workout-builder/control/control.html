<div class="control" (click)="this.toggleSelected()" [class.selected]="this.block()?.selected">
  <button type="button" cdkDragHandle aria-label="Drag step" class="drag-handle">⋮⋮</button>
  <div class="card-title" [title]="block()?.name">{{ block()?.name }}</div>

  @if (isRepeat()) {
    <form [formGroup]="repeatForm" class="form-grid">
      <mat-form-field class="form-field form-title">
        <mat-label>Sets</mat-label>
        <input matInput type="number" formControlName="sets" min="1" />
      </mat-form-field>
    </form>
  }

  @if (isWorkout()) {
    <form [formGroup]="workoutForm" class="form-grid" (click)="$event.stopPropagation()">
      <mat-form-field class="form-field form-title">
        <mat-label>Name override</mat-label>
        <input matInput type="text" formControlName="nameOverride" placeholder="Custom name" />
      </mat-form-field>

      <mat-form-field class="form-field">
        <mat-label>Intensity</mat-label>
        <mat-select formControlName="intensity">
          @for (opt of intensityOptions; track opt.value) {
            <mat-option [value]="opt.value">{{ opt.label }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      <app-step-target [(workoutBlock)]="this.workoutOrUndefined" class="step-target" />
    </form>
  }
</div>
